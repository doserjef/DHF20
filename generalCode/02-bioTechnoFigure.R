rm(list = ls())
# Alpha and Beta Computation Figure ---------------------------------------

library(tuneR)
library(seewave)
library(colorspace)
library(pBrackets)
recording <- readWave("../data/recordings/MINUTE-MCP-C_20160610_072606003.wav")
summary(recording)
curr <- par()$mar
png("../figures/alphaBetaComputation.png", width = 758, height = 412)
par(mar=c(5.0,4.1,4.1,17.5))
spectro(recording, colbg = "white", flim = c(0.5, 11), palette = spectro.colors, scale = FALSE, 
        grid = FALSE, cexlab = 1.25, cexaxis = 1.25)
abline(h = 2, lty = 2, col = 'grey')
abline(h = 3.5, lty = 2, col = 'grey')
abline(h = 5, lty = 2, col = 'grey')
abline(h = 6.5, lty = 2, col = 'grey')
abline(h = 8, lty = 2, col = 'grey')
abline(h = 9.5, lty = 2, col = 'grey')
abline(h = 11, lty = 2, col = 'grey')
arrows(x0 = 61, y0 = 1.1, x1 = 70, y1 = 1.1, xpd = TRUE, len = 0.05)
text(73, 1.1, expression(PSD[1]), xpd = TRUE, cex = 1.25)
arrows(x0 = 76, y0 = 1.1, x1 = 82, y1 = 1.1, xpd = TRUE, len = 0.05)
text(84, 1.05, expression(alpha[ijk]), xpd = TRUE, cex = 1.25)
arrows(x0 = 61, y0 = 10.25, x1 = 70, y1 = 10.25, xpd = TRUE, len = 0.05)
text(73, 10.25, expression(PSD[7]), xpd = TRUE, cex = 1.25)
arrows(x0 = 61, y0 = 8.75, x1 = 70, y1 = 8.75, xpd = TRUE, len = 0.05)
text(73, 8.75, expression(PSD[6]), xpd = TRUE, cex = 1.25)
arrows(x0 = 61, y0 = 7.25, x1 = 70, y1 = 7.25, xpd = TRUE, len = 0.05)
text(73, 7.25, expression(PSD[5]), xpd = TRUE, cex = 1.25)
arrows(x0 = 61, y0 = 5.75, x1 = 70, y1 = 5.75, xpd = TRUE, len = 0.05)
text(73, 5.75, expression(PSD[4]), xpd = TRUE, cex = 1.25)
arrows(x0 = 61, y0 = 4.25, x1 = 70, y1 = 4.25, xpd = TRUE, len = 0.05)
text(73, 4.25, expression(PSD[3]), xpd = TRUE, cex = 1.25)
arrows(x0 = 61, y0 = 2.75, x1 = 70, y1 = 2.75, xpd = TRUE, len = 0.05)
text(73, 2.75, expression(PSD[2]), xpd = TRUE, cex = 1.25)
brackets(76, 11, 76, 2, lwd=2, xpd = TRUE)
text(85, 6.5, expression(sum(PSD[i], i==2,7) %/% 6 == y[ijk]), xpd = TRUE, cex = 1.25)
dev.off()